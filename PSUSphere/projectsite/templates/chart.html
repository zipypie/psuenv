{% extends 'base.html' %}
{% load static %}

{% block content %}
<div class="page-inner" style="margin: 100px 50px">
  <div class="row">
    <div class="col-md-6">
      <div class="card">
        <div class="card-header">
          <div class="card-title">Number of Members of Every Organization</div>
        </div>
        <div class="card-body">
          <div class="chart-container">
            <canvas id="doughnut-chart" style="width: 100%; height: 400px;"></canvas>
          </div>
        </div>
      </div>
    </div>
    <div class="col-md-6">
      <div class="card">
        <div class="card-header">
          <div class="card-title">Number of students of every Colleges</div>
        </div>
        <div class="card-body">
          <div class="chart-container">
            <canvas id="doughnut-chart-college" style="width: 100%; height: 400px;"></canvas>
          </div>
        </div>
      </div>
    </div>
    <div class="col-md-6">
      <div class="card">
        <div class="card-header">
          <div class="card-title">Number of students of every Colleges</div>
        </div>
        <div class="card-body">
          <div class="chart-container">
            <canvas id="radar-chart-college" style="width: 100%; height: 400px;"></canvas>
          </div>
        </div>
      </div>
    </div>
    <div class="col-md-12">
      <div class="card">
        <div class="card-header">
          <div class="card-title">Chart with HTML Legends</div>
        </div>
        <div class="card-body">
            <div class="chart-container">
            <canvas id="html-legends-chart" style="width: 100%; height: 400px;"></canvas>
          </div>
          <div id="myChartLegend"></div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}

{% block chart %}
<script>
  function loadDoughnutChartData() {
    fetch("/doughnut-chart/")
      .then((response) => response.json())
      .then((data) => {
        var labels = Object.keys(data);
        var counts = Object.values(data);

        doughnutChart.data.labels = labels;
        doughnutChart.data.datasets[0].data = counts;

        doughnutChart.update();
      })
      .catch((error) => {
        console.error("Error fetching data:", error);
      });
  }

  function loadDoughnutChartCollegeData() {
    fetch("/doughnut-chart-college/")
      .then((response) => response.json())
      .then((data) => {
        var labels = Object.keys(data);
        var counts = Object.values(data);

        doughnutChartCollege.data.labels = labels;
        doughnutChartCollege.data.datasets[0].data = counts;

        doughnutChartCollege.update();
      })
      .catch((error) => {
        console.error("Error fetching data:", error);
      });
  }

  function loadRadarChartData() {
    fetch("/radar-chart-college/")
      .then(response => response.json())
      .then(data => {
        var labels = Object.keys(data);
        var counts = Object.values(data);
        
        myRadarChart.data.labels = labels;
        myRadarChart.data.datasets[0].data = counts;
        myRadarChart.update();
      })
      .catch(error => {
        console.error('Error fetching data:', error);
      });
  }


  function loadHtmlLegendsChartData() {
    fetch("/html-legends-chart/")
      .then(response => response.json())
      .then(data => {
        var labels = data.labels;
        var counts = data.counts;
        var randomColors = generateRandomColors(labels.length);
  
        // Update chart data
        myHtmlLegendsChart.data.labels = labels;
        myHtmlLegendsChart.data.datasets[0].data = counts;
        myHtmlLegendsChart.data.datasets[0].borderColor = randomColors;
        myHtmlLegendsChart.data.datasets[0].pointBackgroundColor = randomColors;
        myHtmlLegendsChart.data.datasets[0].backgroundColor = randomColors;
        myHtmlLegendsChart.data.datasets[0].legendColor = randomColors;
  
        // Update legend
        updateLegend(labels, randomColors);
  
        // Update chart
        myHtmlLegendsChart.update();
      })
      .catch(error => {
        console.error('Error fetching data:', error);
      });
  }
  
  function updateLegend(labels, colors) {
    var legendContainer = document.getElementById("myChartLegend");
    legendContainer.innerHTML = ""; // Clear existing legend
  
    for (var i = 0; i < labels.length; i++) {
      var label = labels[i];
      var color = colors[i];
  
      var legendItem = document.createElement("div");
      legendItem.classList.add("legend-item");
  
      var colorBox = document.createElement("span");
      colorBox.classList.add("color-box");
      colorBox.style.backgroundColor = color;
  
      var labelSpan = document.createElement("span");
      labelSpan.textContent = label;
  
      legendItem.appendChild(colorBox);
      legendItem.appendChild(labelSpan);
  
      legendContainer.appendChild(legendItem);
    }
  }
  
  function generateRandomColors(count) {
    var colors = [];
    for (var i = 0; i < count; i++) {
      // Generate random RGB values
      var r = Math.floor(Math.random() * 256);
      var g = Math.floor(Math.random() * 256);
      var b = Math.floor(Math.random() * 256);
      var color = `rgba(${r}, ${g}, ${b}, 0.7)`; // Random color with opacity 0.7
      colors.push(color);
    }
    return colors;
  }
  

  
  var doughnutChart = new Chart(document.getElementById("doughnut-chart").getContext("2d"), {
    type: 'doughnut',
    data: {
      labels: [],
      datasets: [{
        label: 'Number of Members',
        data: [],
        backgroundColor: ['rgba(255, 206, 86)', 'rgba(37, 26, 117)', 'rgba(107, 2, 42)', 'rgba(255, 109, 36)', 'rgba(7, 235, 147)', 'rgba(54, 162, 235)'],
        borderWidth: 1
      }]
    },
    options: {
      pieceLabel: {
        render: "percentage",
        fontColor: "white",
        fontSize: 14,
      },
      legend: {
        position: "bottom",
      },
      responsive: true,
      maintainAspectRatio: false,
    }
  });

  var doughnutChartCollege = new Chart(document.getElementById("doughnut-chart-college").getContext("2d"), {
    type: 'doughnut',
    data: {
      labels: [],
      datasets: [{
        label: 'Number of Members',
        data: [],
        backgroundColor: ['rgba(255, 206, 86)', 'rgba(37, 26, 117)', 'rgba(107, 2, 42)', 'rgba(255, 109, 36)', 'rgba(7, 235, 147)', 'rgba(54, 162, 235)'],
        borderWidth: 1
      }]
    },
    options: {
      pieceLabel: {
        render: "percentage",
        fontColor: "white",
        fontSize: 14,
      },
      legend: {
        position: "bottom",
      },
      responsive: true,
      maintainAspectRatio: false,
    }
  });

  var myRadarChart = new Chart(document.getElementById("radar-chart-college").getContext("2d"), {
      type: "radar",
      data: {
        datasets: [
          {
            data: [],
            borderColor: "#1d7af3",
            backgroundColor: "rgba(29, 122, 243, 0.25)",
            pointBackgroundColor: "#1d7af3",
            pointHoverRadius: 4,
            pointRadius: 3,
          },
        ],
      },
      options: {
        responsive: true,
        maintainAspectRatio: false,
        legend: {
          position: "bottom",
        },
      },
    });
  



    // Chart with HTML Legends
  loadHtmlLegendsChartData();
  loadDoughnutChartData();
  loadDoughnutChartCollegeData();
  loadRadarChartData();


</script>
{% endblock %}
